<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Dat Burgurrrr</title>
	<script src="https://unpkg.com/merge-images"></script>
	<!-- CSS only -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
	<!-- JavaScript Bundle with Popper -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
</head>

<body style="padding: 0px 50px;">
	  <center><h1>Burgurr Factory</h1></center>
	  <div class="row">
	  	<div class="col-2">Bun
	  	</div>
	  	<div class="col-2">Meat
	  	</div>
	  	<div class="col-2">Sauce
	  	</div>
	  	<div class="col-2">Cheese
	  	</div>
	  	<div class="col-2">Topping
	  	</div>
	  	<div class="col-2">Side
	  	</div>	  	
	  </div>
	  <div class="row">
	  	<div class="col-2">
			<select id="bun" class="form-select">
			  <option value="00" selected>Pick One...</option>
			  <option value="01">One</option>
			  <option value="02">Two</option>
			  <option value="03">Three</option>
			  <option value="04">Four</option>
			  <option value="05">Five</option>
			  <option value="06">Six</option>
			</select>
	  	</div>
	  	<div class="col-2">
			<select id="meat" class="form-select">
			  <option value="00" selected>Pick One...</option>
			  <option value="01">One</option>
			  <option value="02">Two</option>
			  <option value="03">Three</option>
			  <option value="04">Four</option>
			  <option value="05">Five</option>
			  <option value="06">Six</option>
			</select>
	  	</div>
	  	<div class="col-2">
			<select id="sauce" class="form-select">
			  <option value="00" selected>Pick One...</option>
			  <option value="01">One</option>
			  <option value="02">Two</option>
			  <option value="03">Three</option>
			  <option value="04">Four</option>
			  <option value="05">Five</option>
			  <option value="06">Six</option>
			</select>
	  	</div>
	  	<div class="col-2">
			<select id="cheese" class="form-select">
			  <option value="00" selected>Pick One...</option>
			  <option value="01">One</option>
			  <option value="02">Two</option>
			  <option value="03">Three</option>
			  <option value="04">Four</option>
			  <option value="05">Five</option>
			  <option value="06">Six</option>
			</select>
	  	</div>
	  	<div class="col-2">
			<select id="topping" class="form-select">
			  <option value="00" selected>Pick One...</option>
			  <option value="01">One</option>
			  <option value="02">Two</option>
			  <option value="03">Three</option>
			  <option value="04">Four</option>
			  <option value="05">Five</option>
			  <option value="06">Six</option>
			</select>
	  	</div>
	  	<div class="col-2">
			<select  id="side" class="form-select">
			  <option value="00" selected>Pick One...</option>
			  <option value="01">One</option>
			  <option value="02">Two</option>
			  <option value="03">Three</option>
			  <option value="04">Four</option>
			  <option value="05">Five</option>
			  <option value="06">Six</option>
			</select>
	  	</div>
	  </div>
	  <div class="row" style="margin-top: 10px;">
	  	<div class="col-12">
	  		<center>
	  			<button name="createBurgur" id="createBurgur" type='button' class='btn btn-primary'>Show Burgurr</button>
	  		</center>
	  	</div>
	  </div>
	  <div class="row">
	  	<div class="col-12">
	  		<center>
	  			<canvas id="canvas" width="450" height="450"></canvas>
	  		</center>
	  	</div>
	  </div>
</body>
</html>


<script>

	let imagesLoaded = 0;
	let canvas, ctx;
	let images;
	let imageUrls = [];

	document.addEventListener("DOMContentLoaded",() => {
		console.log("DOM LOADED");
	});

	function drawCanvas() {
		imagesLoaded += 1;
		if (imagesLoaded === images.length) {
		  images.map(image => {
		    ctx.drawImage(image, 0, 0, 450, 450);
		  })
		}
	}

	function loadImage(src, onload) {
		const img = new Image();
		img.onload = onload;
		img.src = src;
		return img;
	}

	$("#createBurgur").click(() => {

		console.log("createBurgur", "click");
		imageUrls = [];
		imagesLoaded = 0;

		let side = $( "#side" ).val();
		let topping = $( "#topping" ).val();
		let meat = $( "#meat" ).val();
		let sauce = $( "#sauce" ).val();
		let cheese = $( "#cheese" ).val();
		let bun = $( "#bun" ).val();

		if(side != "00") {
			imageUrls.push("https://goblintown.wtf/mcgoblin/i/traits/background/background" + side +".png");
		}
		if(bun != "00") {
			imageUrls.push("https://goblintown.wtf/mcgoblin/i/traits/bottom-bun/bottombun" + bun +".png");
		}
		if(sauce != "00") {
			imageUrls.push("https://goblintown.wtf/mcgoblin/i/traits/sauce/sauce" + sauce +".png");
		}
		if(meat != "00") {
			imageUrls.push("https://goblintown.wtf/mcgoblin/i/traits/meat/meat" + meat +".png");
		}
		if(cheese != "00") {
			imageUrls.push("https://goblintown.wtf/mcgoblin/i/traits/cheese/cheese" + cheese +".png");
		}
		if(topping != "00") {
			imageUrls.push("https://goblintown.wtf/mcgoblin/i/traits/topping/topping" + topping +".png");
		}
		if(bun != "00") {
			imageUrls.push("https://goblintown.wtf/mcgoblin/i/traits/top-bun/topbun" + bun +".png");
		}

		console.log("createBurgur", imageUrls);

		canvas = document.getElementById("canvas");
		ctx = canvas.getContext("2d");
		ctx.clearRect(0, 0, canvas.width, canvas.height);
		images = imageUrls.map(imageUrl => loadImage(imageUrl, drawCanvas))
	})

</script>
